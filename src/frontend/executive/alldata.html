<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <link rel="stylesheet" href="alldatastyle.css">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;

    }

    .content-area {

      margin-left: 290px;
      /* Matches the sidebar's width */
      padding: 20px;
      background-color: #f8f9fa;
      min-height: 100vh;
      /* Ensure the content area stretches to full height */
    }

    /* Responsive: จอเล็ก */
    @media (max-width: 576px) {
      .sidebar {
        position: relative;
        width: 100%;
        box-shadow: none;
      }

      .content-area {
        margin-left: 0;
      }
    }

    .sidebar .btn:last-child {
      margin-top: auto;
      /* ดันปุ่มให้อยู่ล่างสุด */
    }

    .canvas {
      width: 100%;
      /* Expand canvas width */
      max-width: 600px;
      /* Optional: Set a max width */
      height: 500px;
      /* Increase height for better vertical display */
    }
  </style>
</head>

<body>
<div id="sidebar-container"></div>
  <div class="content-area">
    <!-- เนื้อหาในส่วนนี้จะไม่ถูก Sidebar ทับ -->
    <div class="container" onclick="window.location.href='detailroom.html';">
      <section class="charts">
        <div class="chart-header">
          <h3 class="most-room">ห้องที่ใช้เยอะที่สุด</h3>
        </div>
        <div style="display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap;">
          <!-- Bar Chart -->
          <div style="width: 600px; height: 300px; margin-top: 40px;">
            <canvas id="barChart"></canvas>
          </div>
        </div>
      </section>
    </div>


    <div class="container-two">
      <section class="graph">
        <div class="graph-container">
          <div>
            <h3 class="graph-header">จำนวนคนจอง/สัปดาห์</h3>
          </div>
          <div>
            <img src="graph.png" alt="graphpeople">
          </div>
          <div>
            <p class="box-it"></p>
            <p>จำนวนนิสิต สาขา เทคโนโลยีฯ</p>
            <p class="box-com"></p>
            <p>จำนวนนิสิต สาขา วิทยาการคอมฯ</p>
          </div>
        </div>
      </section>
      <section class="monthly">
        <div class="monthly-container">
          <div>
            <h3 class="monthly-header">จำนวนคน/เดือน</h3>
          </div>
          <div>
            <img src="monthly.png">
          </div>
        </div>
      </section>
    </div>

    <div class="container-three">
      <section class="equipment">
        <div class="equip-container">
          <div>
            <h3 class="equip-header">อุปกรณ์</h3>
          </div>
          <div onclick="window.location.href='broken_equipment.html';" style="cursor: pointer;">
            <div style="width: auto; height: auto;">
              <canvas id="doughnutChart1"></canvas>
            </div>
          </div>
          <div onclick="window.location.href='borrow_equipment.html';"style="cursor: pointer;">
            <div style="width: auto; height: auto;">
              <canvas id="doughnutChart2"></canvas>
            </div>
          </div>
          <button onclick="window.location.href='eqiup.html'" >Details</button>
      </section>
      <section class="moststuden">
        <div class="moststuden-container">
          <div>
            <h3 class="moststuden-header">นิสิตที่ใช้ห้องบ่อยที่สุด</h3>
          </div>
          <div>
            <section>
              <div class="split-container">
                <p3>นาย คำมี สาเก</p3>
                <p4>5 ครั้ง</p4>
              </div>
              <br>
              <div class="split-container">
                <p3>นางสาว อุ้งอิ้ง องค์กร</p3>
                <p4>3 ครั้ง</p4>
              </div>
              <br>
              <div class="split-container">
                <p3>นาย ธีรพงษ์ พาสุข</p3>
                <p4>2 ครั้ง</p4>
              </div>
            </section>
            <button onclick="window.location.href='student.html';">Details</button>
          </div>

        </div>
      </section>
    </div>
  </div>
  <script>
    // fetch sidebar
    fetch("sidebar.html")
        .then((resp) => resp.text())
        .then((html) => {
          // แทรก Sidebar เข้ามา
          document.getElementById("sidebar-container").innerHTML = html;
        })
        .then(() => {
          // เมื่อตัว Sidebar ถูกโหลดเข้ามาใน DOM แล้ว
          // ให้ Highlight ปุ่มสถิติ
          const btnStats = document.getElementById("btnStatistic");
          btnStats.classList.add("btn-sidebar-active");
        })
        .catch((err) => console.error("Failed to load sidebar:", err));
      // end of fetch sidebar
    // Bar Chart Data
    const barCtx = document.getElementById('barChart').getContext('2d');
    new Chart(barCtx, {
      type: 'bar',
      data: {
        labels: ['SC2-212', 'SC2-401', 'SC2-214', 'SC2-208', 'SC2-301'],
        datasets: [
          {
            label: 'จำนวนนิสิตรวม',
            data: [301, 227, 205, 200, 108],
            backgroundColor: '#E5D2BA'
          },
          {
            label: 'จำนวนนิสิต สาขา วิทยาการคอมฯ',
            data: [177, 210, 118, 75, 50],
            backgroundColor: '#E54715'
          },
          {
            label: 'จำนวนนิสิต สาขาเทคโนโลยีฯ',
            data: [124, 17, 87, 125, 108],
            backgroundColor: '#622BBE'
          }
        ]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: 'bottom' // Position legend at the bottom
          },
          title: {
            display: true,
            text: 'ข้อมูลจำนวนนิสิต'
          }
        },
        scales: {
          y: {
            beginAtZero: true
          }
        }
      }
    });

    // Doughnut Chart 1 Data
    const doughnutCtx1 = document.getElementById('doughnutChart1').getContext('2d');
    new Chart(doughnutCtx1, {
      type: 'doughnut',
      data: {
        labels: ['โปรเจกเตอร์', 'เก้าอี้', 'วิชวลไลเซอร์'],
        datasets: [{
          data: [10, 5, 2],
          backgroundColor: ['#E5D2BA', '#E54715', '#622BBE'],
          hoverOffset: 8
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: 'bottom' // Position legend at the bottom
          },
          title: {
            display: true,
            text: 'อุปกรณ์ที่ชำรุดบ่อย'
          },
          tooltip:{
            enabled:true,
            callbacks:{
              label: function(tooltipItem){
                return tooltipItem.label+':'+tooltipItem.raw;
              }
            }
          },
        }
      }
    });

    // Doughnut Chart 2 Data
    const doughnutCtx2 = document.getElementById('doughnutChart2').getContext('2d');
    new Chart(doughnutCtx2, {
      type: 'doughnut',
      data: {
        labels: ['ไมค์', 'ปลี๊กไฟ', 'Pointer'],
        datasets: [{
          data: [8, 12, 5],
          backgroundColor: ['#E5D2BA', '#E54715', '#622BBE'],
          hoverOffset: 8
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: 'bottom' // Position legend at the bottom
          },
          title: {
            display: true,
            text: 'อุปกรณ์ที่ยืมบ่อย'
          },
          tooltip:{
            enabled:true,
            callbacks:{
              label: function(tooltipItem){
                return tooltipItem.label+':'+tooltipItem.raw;
              }
            }
          },
        }
      }
    });
  </script>
</body>

</html>